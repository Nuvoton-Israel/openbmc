From c3ae021c7fd1ebfc6de854b0965d45cd4baaf8ed Mon Sep 17 00:00:00 2001
From: Stanley Chu <yschu@nuvoton.com>
Date: Thu, 18 Nov 2021 11:20:12 +0800
Subject: [PATCH] dts: meta-evb-npcm845: update pin configuration for SPI flash
 on PSPI

Signed-off-by: Stanley Chu <yschu@nuvoton.com>
---
 .../boot/dts/nuvoton/nuvoton-npcm845-evb.dts     |  8 ++++++--
 .../dts/nuvoton/nuvoton-npcm845-pincfg-evb.dtsi  | 16 ++++++++++++++++
 2 files changed, 22 insertions(+), 2 deletions(-)

diff --git a/arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-evb.dts b/arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-evb.dts
index 099fe7e68864..2153456edbff 100644
--- a/arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-evb.dts
+++ b/arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-evb.dts
@@ -492,7 +492,7 @@
 			};
 
 			spi1: spi@201000 {
-				cs-gpios = <&gpio0 20 GPIO_ACTIVE_LOW>;
+				cs-gpios = <&gpio0 15 GPIO_ACTIVE_LOW>;
 				status = "okay";
 				Flash@0 {
 					compatible = "jedec,spi-nor";
@@ -556,6 +556,10 @@
 				&pin242_slew
 				&pin243_slew
 				&spix_pins
+				&pin17_slew
+				&pin18_slew
+				&pin19_slew
+				&pin20_slew
 				&pin4_slew
 				&pin5_slew
 				&pin6_slew
@@ -642,7 +646,7 @@
 };
 
 &i2c15 {
-	status = "okay";
+	status = "disabled";
 };
 
 &i2c16 {
diff --git a/arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-pincfg-evb.dtsi b/arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-pincfg-evb.dtsi
index 0cdb35aa8e87..52665c5a1ba1 100644
--- a/arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-pincfg-evb.dtsi
+++ b/arch/arm64/boot/dts/nuvoton/nuvoton-npcm845-pincfg-evb.dtsi
@@ -80,5 +80,21 @@
 			pins = "GPIO7/IOX2_D0/SMB2D_SCL";
 			slew-rate = <1>;
 		};
+		pin17_slew: pin17_slew {
+			pins = "GPIO17/PSPI_DI/CP1_GPIO5";
+			slew-rate = <1>;
+		};
+		pin18_slew: pin18_slew {
+			pins = "GPIO18/PSPI_D0/SMB4B_SDA";
+			slew-rate = <1>;
+		};
+		pin19_slew: pin19_slew {
+			pins = "GPIO19/PSPI_CK/SMB4B_SCL";
+			slew-rate = <1>;
+		};
+		pin20_slew: pin20_slew {
+			pins = "GPIO20/H_GPIO0/SMB4C_SDA/SMB15_SDA";
+			slew-rate = <1>;
+		};
 	};
 };
-- 
2.17.1

